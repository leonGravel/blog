<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>【转载】java.lang.String - gravel&#39;s blog</title><meta name=renderer content=webkit><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv=cache-control content=no-transform><meta http-equiv=cache-control content=no-siteapp><meta name=theme-color content=#f8f5ec><meta name=msapplication-navbutton-color content=#f8f5ec><meta name=apple-mobile-web-app-capable content=yes><meta name=apple-mobile-web-app-status-bar-style content=#f8f5ec><meta name=author content=Gravel><meta name=description content="整理一下关于String类的方法。 概览 继承结构 Serializable CharSequence Comparable 字符集简介 重要域成员 重要方法 代码点及代码单元 比较 搜索 提取子串 创建全大写/全小写副本 一些体"><meta name=keywords content="Hugo,gravel's blog"><meta name=generator content="Hugo 0.57.2 with even 4.0.0"><link rel=canonical href=https://leongravel.com/post/java.lang.string/><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/manifest.json><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><link href=/dist/even.1cafc379.min.css rel=stylesheet><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin=anonymous><meta property=og:title content=【转载】java.lang.String><meta property=og:description content="整理一下关于String类的方法。 概览 继承结构 Serializable CharSequence Comparable 字符集简介 重要域成员 重要方法 代码点及代码单元 比较 搜索 提取子串 创建全大写/全小写副本 一些体"><meta property=og:type content=article><meta property=og:url content=https://leongravel.com/post/java.lang.string/><meta property=article:published_time content=2018-03-12T20:54:41+00:00><meta property=article:modified_time content=2018-03-12T20:54:41+00:00><meta itemprop=name content=【转载】java.lang.String><meta itemprop=description content="整理一下关于String类的方法。 概览 继承结构 Serializable CharSequence Comparable 字符集简介 重要域成员 重要方法 代码点及代码单元 比较 搜索 提取子串 创建全大写/全小写副本 一些体"><meta itemprop=datePublished content=2018-03-12T20:54:41&#43;00:00><meta itemprop=dateModified content=2018-03-12T20:54:41&#43;00:00><meta itemprop=wordCount content=1808><meta itemprop=keywords content=java,><meta name=twitter:card content=summary><meta name=twitter:title content=【转载】java.lang.String><meta name=twitter:description content="整理一下关于String类的方法。 概览 继承结构 Serializable CharSequence Comparable 字符集简介 重要域成员 重要方法 代码点及代码单元 比较 搜索 提取子串 创建全大写/全小写副本 一些体"><!--[if lte IE 9]><script src=https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js></script><![endif]--><!--[if lt IE 9]><script src=https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js></script><script src=https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js></script><![endif]--></head><body><div id=mobile-navbar class=mobile-navbar><div class=mobile-header-logo><a href=/ class=logo>gravel&#39;s blog</a></div><div class=mobile-navbar-icon><span></span><span></span><span></span></div></div><nav id=mobile-menu class="mobile-menu slideout-menu"><ul class=mobile-menu-list><a href=/><li class=mobile-menu-item>Home</li></a><a href=/post/><li class=mobile-menu-item>Archives</li></a><a href=/tags/><li class=mobile-menu-item>Tags</li></a><a href=/categories/><li class=mobile-menu-item>Categories</li></a><a href=/resume><li class=mobile-menu-item>Resume</li></a><a href=/about><li class=mobile-menu-item>About</li></a></ul></nav><div class=container id=mobile-panel><header id=header class=header><div class=logo-wrapper><a href=/ class=logo>gravel&#39;s blog</a></div><nav class=site-navbar><ul id=menu class=menu><li class=menu-item><a class=menu-item-link href=/>Home</a></li><li class=menu-item><a class=menu-item-link href=/post/>Archives</a></li><li class=menu-item><a class=menu-item-link href=/tags/>Tags</a></li><li class=menu-item><a class=menu-item-link href=/categories/>Categories</a></li><li class=menu-item><a class=menu-item-link href=/resume>Resume</a></li><li class=menu-item><a class=menu-item-link href=/about>About</a></li></ul></nav></header><main id=main class=main><div class=content-wrapper><div id=content class=content><article class=post><header class=post-header><h1 class=post-title>【转载】java.lang.String</h1><div class=post-meta><span class=post-time>2018-03-12</span><div class=post-category><a href=/categories/coding/>Coding</a></div><span class=more-meta>1808 words</span>
<span class=more-meta>4 mins read</span>
<span id=busuanzi_container_page_pv class=more-meta><span id=busuanzi_value_page_pv><img src=/img/spinner.svg alt=spinner.svg></span> times read</span></div></header><div class=post-toc id=post-toc><h2 class=post-toc-title>Contents</h2><div class="post-toc-content always-active"><nav id=TableOfContents><ul><li><ul><li><a href=#概览>概览</a></li><li><a href=#继承结构>继承结构</a><ul><li><a href=#serializable>Serializable</a></li><li><a href=#charsequence>CharSequence</a></li><li><a href=#comparable-t>Comparable<t></a></li></ul></li><li><a href=#字符集简介>字符集简介</a></li><li><a href=#重要域成员>重要域成员</a></li><li><a href=#重要方法>重要方法</a><ul><li><a href=#代码点及代码单元>代码点及代码单元</a></li><li><a href=#比较>比较</a></li><li><a href=#搜索>搜索</a></li><li><a href=#提取子串>提取子串</a></li><li><a href=#创建全大写-全小写副本>创建全大写/全小写副本</a></li></ul></li><li><a href=#一些体会>一些体会</a></li><li><a href=#参考>参考</a></li></ul></li></ul></nav></div></div><div class=post-content><p>整理一下关于String类的方法。</p><hr><ul><li><a href=#概览>概览</a></li><li><a href=#继承结构>继承结构</a><ul><li><a href=#serializable>Serializable</a></li><li><a href=#charsequence>CharSequence</a></li><li><a href=#comparablet>Comparable<t></a></li></ul></li><li><a href=#字符集简介>字符集简介</a></li><li><a href=#重要域成员>重要域成员</a></li><li><a href=#重要方法>重要方法</a><ul><li><a href=#代码点及代码单元>代码点及代码单元</a></li><li><a href=#比较>比较</a></li><li><a href=#搜索>搜索</a></li><li><a href=#提取子串>提取子串</a></li><li><a href=#创建全大写全小写副本>创建全大写/全小写副本</a></li></ul></li><li><a href=#一些体会>一些体会</a></li><li><a href=#参考>参考</a></li></ul><hr><h2 id=概览>概览</h2><p><code>String</code> 类代表了字符串。所有类似于 <code>&quot;abc&quot;</code> 的字符串字面量都是该类的实例。</p><p>字符串是常量，从创建后就不可更改。需要修改的字符串可以使用 <code>StringBuffer</code>。因为 <code>String</code> 实例不可变，所以他们可以安全的共享。一些例子：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code class=language-java data-lang=java><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-java data-lang=java><span class=n>String</span> <span class=nf>str</span> <span class=o>=</span> <span class=s>&#34;abc&#34;</span><span class=p>;</span>
<span class=c1>// 与上面一行代码效果相同
</span><span class=c1></span><span class=kt>char</span> <span class=nf>data</span><span class=p>[]</span> <span class=o>=</span> <span class=p>{</span><span class=sc>&#39;a&#39;</span><span class=p>,</span> <span class=sc>&#39;b&#39;</span><span class=p>,</span> <span class=sc>&#39;c&#39;</span><span class=p>};</span>
<span class=n>String</span> <span class=nf>str</span> <span class=o>=</span> <span class=k>new</span> <span class=n>String</span><span class=p>(</span><span class=n>data</span><span class=p>);</span>


<span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&#34;abc&#34;</span><span class=p>);</span>
<span class=n>String</span> <span class=nf>cde</span> <span class=o>=</span> <span class=s>&#34;cde&#34;</span><span class=p>;</span>
<span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&#34;abc&#34;</span> <span class=o>+</span> <span class=n>cde</span><span class=p>);</span>
<span class=n>String</span> <span class=nf>c</span> <span class=o>=</span> <span class=s>&#34;abc&#34;</span><span class=p>.</span><span class=na>substring</span><span class=p>(</span><span class=n>2</span><span class=p>,</span><span class=n>3</span><span class=p>);</span>
<span class=n>String</span> <span class=nf>d</span> <span class=o>=</span> <span class=n>cde</span><span class=p>.</span><span class=na>substring</span><span class=p>(</span><span class=n>1</span><span class=p>,</span> <span class=n>2</span><span class=p>);</span></code></pre></td></tr></table></div></div><p><code>String</code> 类也包含了一些对单个字符的操作、比较、搜索、提取子串、创建全大写/全小写副本的方法。</p><p>Java 语言为字符串连接操作符(+)添加了特殊支持。向左连接。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code class=language-java data-lang=java><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-java data-lang=java><span class=c1>//  example 1
</span><span class=c1></span><span class=s>&#34;The square root of 2 is &#34;</span> <span class=o>+</span> <span class=n>Math</span><span class=p>.</span><span class=na>sqrt</span><span class=p>(</span><span class=n>2</span><span class=p>)</span>
  <span class=o>|</span>
  <span class=n>v</span>
<span class=s>&#34;The square root of 2 is 1.4142135623730952&#34;</span>

<span class=c1>// example 2
</span><span class=c1></span><span class=n>1</span> <span class=o>+</span> <span class=n>2</span> <span class=o>+</span> <span class=s>&#34; fiddlers&#34;</span>
  <span class=o>|</span>
  <span class=n>v</span>
<span class=s>&#34;3 fiddlers&#34;</span>

<span class=c1>// example 3
</span><span class=c1></span><span class=s>&#34;fiddlers &#34;</span> <span class=o>+</span> <span class=n>1</span> <span class=o>+</span> <span class=n>2</span>
  <span class=o>|</span>
  <span class=n>v</span>
<span class=s>&#34;fiddlers 12&#34;</span></code></pre></td></tr></table></div></div><p><code>String</code> 使用 UTF-16 来编码（一个字符两个字节或四个字节）。拓展字符用 surrogate pairs 来表示，占用四个字节。（PS：该术语是编码领域的，可以参考之前写的一篇笔记: <a href=../common/unicodeStandard.md>Unicode 学习笔记</a>）</p><p><code>String</code> 也提供了一些处理代码点(Unicode code points)和代码单元(Unicode code units)的方法(PS:这两个也是编码领域术语，可以参考：<a href=../common/unicodeStandard.md>Unicode 学习笔记</a>)。</p><p>String 连接操作符的具体实现留给 Java 编译器来决定，只要编译器能够完全遵循 Java 语言规范即可。例如 <code>javac</code> 编译器可能用 <code>StringBuffer</code>、<code>StringBuilder</code> 或 <code>java.lang.invoke.StringCOncatFactory</code> 来实现。</p><h2 id=继承结构>继承结构</h2><h3 id=serializable>Serializable</h3><p>类通过实现 <code>java.io.Serializable</code> 接口来启用序列化能力。未实现该接口的类其状态将不会被序列化(抛出 <code>NotSerializableException</code> 异常)。该接口没有任何域或方法，只是表示可序列化的语义。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code class=language-java data-lang=java><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-java data-lang=java>    <span class=kd>public</span> <span class=nf>static</span> <span class=kt>void</span> <span class=nf>serializableTest</span><span class=p>()</span> <span class=kd>throws</span> <span class=nf>IOException</span><span class=p>,</span> <span class=n>ClassNotFoundException</span> <span class=p>{</span>
        <span class=n>String</span> <span class=nf>outputfile</span> <span class=o>=</span> <span class=s>&#34;/Users/chen/Desktop/serializable&#34;</span><span class=p>;</span>
        <span class=n>ST</span> <span class=nf>instance</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ST</span><span class=p>();</span>

        <span class=n>ObjectOutputStream</span> <span class=nf>outputStream</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ObjectOutputStream</span><span class=p>(</span><span class=k>new</span> <span class=n>FileOutputStream</span><span class=p>(</span><span class=n>outputfile</span><span class=p>));</span>
        <span class=n>outputStream</span><span class=p>.</span><span class=na>writeObject</span><span class=p>(</span><span class=n>instance</span><span class=p>);</span>
        <span class=n>outputStream</span><span class=p>.</span><span class=na>close</span><span class=p>();</span>

        <span class=n>ObjectInputStream</span> <span class=nf>inputStream</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ObjectInputStream</span><span class=p>(</span><span class=k>new</span> <span class=n>FileInputStream</span><span class=p>(</span><span class=n>outputfile</span><span class=p>));</span>
        <span class=n>ST</span> <span class=nf>newInstance</span> <span class=o>=</span> <span class=p>(</span><span class=n>ST</span><span class=p>)</span> <span class=n>inputStream</span><span class=p>.</span><span class=na>readObject</span><span class=p>();</span>
        <span class=n>inputStream</span><span class=p>.</span><span class=na>close</span><span class=p>();</span>

        <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>newInstance</span><span class=p>);</span>
        <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>instance</span><span class=p>.</span><span class=na>equals</span><span class=p>(</span><span class=n>newInstance</span><span class=p>));</span>  <span class=c1>// true
</span><span class=c1></span>        <span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>instance</span> <span class=o>==</span> <span class=n>newInstance</span><span class=p>);</span> <span class=c1>//false
</span><span class=c1></span>    <span class=p>}</span>

    <span class=kd>static</span> <span class=nf>class</span> <span class=n>ST</span> <span class=nf>implements</span> <span class=n>Serializable</span><span class=p>{</span>
        <span class=kd>public</span> <span class=nf>int</span> <span class=n>publicField</span> <span class=o>=</span> <span class=n>1</span><span class=p>;</span>
        <span class=kd>protected</span> <span class=nf>int</span> <span class=n>protectedField</span> <span class=o>=</span> <span class=n>1</span><span class=p>;</span>
        <span class=kt>int</span> <span class=nf>defaultField</span> <span class=o>=</span> <span class=n>1</span><span class=p>;</span>
        <span class=kd>private</span> <span class=nf>int</span> <span class=n>privateField</span> <span class=o>=</span> <span class=n>1</span><span class=p>;</span>

        <span class=nd>@Override</span>
        <span class=kd>public</span> <span class=nf>boolean</span> <span class=n>equals</span><span class=p>(</span><span class=n>Object</span> <span class=nf>o</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>if</span> <span class=p>(</span><span class=k>this</span> <span class=o>==</span> <span class=n>o</span><span class=p>)</span> <span class=p>{</span>
                <span class=k>return</span> <span class=kc>true</span><span class=p>;</span>
            <span class=p>}</span>
            <span class=k>if</span> <span class=p>(</span><span class=n>o</span> <span class=o>==</span> <span class=kc>null</span> <span class=o>||</span> <span class=n>getClass</span><span class=p>()</span> <span class=o>!=</span> <span class=n>o</span><span class=p>.</span><span class=na>getClass</span><span class=p>())</span> <span class=p>{</span>
                <span class=k>return</span> <span class=kc>false</span><span class=p>;</span>
            <span class=p>}</span>
            <span class=n>ST</span> <span class=nf>st</span> <span class=o>=</span> <span class=p>(</span><span class=n>ST</span><span class=p>)</span> <span class=n>o</span><span class=p>;</span>
            <span class=k>return</span> <span class=n>publicField</span> <span class=o>==</span> <span class=n>st</span><span class=p>.</span><span class=na>publicField</span> <span class=o>&amp;&amp;</span>
                    <span class=n>protectedField</span> <span class=o>==</span> <span class=n>st</span><span class=p>.</span><span class=na>protectedField</span> <span class=o>&amp;&amp;</span>
                    <span class=n>defaultField</span> <span class=o>==</span> <span class=n>st</span><span class=p>.</span><span class=na>defaultField</span> <span class=o>&amp;&amp;</span>
                    <span class=n>privateField</span> <span class=o>==</span> <span class=n>st</span><span class=p>.</span><span class=na>privateField</span><span class=p>;</span>
        <span class=p>}</span>

        <span class=nd>@Override</span>
        <span class=kd>public</span> <span class=nf>int</span> <span class=n>hashCode</span><span class=p>()</span> <span class=p>{</span>
            <span class=k>return</span> <span class=n>Objects</span><span class=p>.</span><span class=na>hash</span><span class=p>(</span><span class=n>publicField</span><span class=p>,</span> <span class=n>protectedField</span><span class=p>,</span> <span class=n>defaultField</span><span class=p>,</span> <span class=n>privateField</span><span class=p>);</span>
        <span class=p>}</span>

        <span class=nd>@Override</span>
        <span class=kd>public</span> <span class=nf>String</span> <span class=n>toString</span><span class=p>()</span> <span class=p>{</span>
            <span class=k>return</span> <span class=s>&#34;ST{&#34;</span> <span class=o>+</span>
                    <span class=s>&#34;publicField=&#34;</span> <span class=o>+</span> <span class=n>publicField</span> <span class=o>+</span>
                    <span class=s>&#34;, protectedField=&#34;</span> <span class=o>+</span> <span class=n>protectedField</span> <span class=o>+</span>
                    <span class=s>&#34;, defaultField=&#34;</span> <span class=o>+</span> <span class=n>defaultField</span> <span class=o>+</span>
                    <span class=s>&#34;, privateField=&#34;</span> <span class=o>+</span> <span class=n>privateField</span> <span class=o>+</span>
                    <span class=sc>&#39;}&#39;</span><span class=p>;</span>
        <span class=p>}</span>
    <span class=p>}</span></code></pre></td></tr></table></div></div><p>序列化的对象中引用的所有对象都必须实现了该接口，否则也会抛出 <code>NotSerializableException</code> 异常。</p><h3 id=charsequence>CharSequence</h3><p>一个 <code>CharSequence</code> 是一个只读的 <code>char</code> 序列。该接口为不同的实现提供了统一的只读访问。</p><p>该接口并没有重新定义 <code>equals() &amp; hashCode()</code> 方法，直接比较两个实现类的实例结果是未定义的。所以将 <code>CharSequence</code> 的实例作为 <code>set</code> 的元素或 <code>map</code> 的 <code>key</code> 是不合适的。</p><p>主要的实现类：<code>CharBuffer, Segment, String, StringBuffer, StringBuilder</code></p><p><code>String</code> 中也实现了与 <code>CharSequence</code> 实例进行比较、拼接等操作的函数。</p><h3 id=comparable-t>Comparable<t></h3><p>主要用于集合中元素排序，两个元素直接比较。</p><h2 id=字符集简介>字符集简介</h2><p><code>String</code> 类中用到了两种字符集 <code>Latin1 &amp; UTF-16</code>. <code>Latin1</code> 拓展了 <code>ASCII</code> 编码，但是也是用一个字节来表示，<code>UTF-16</code> 使用两个或四个字节表示一个字符。简要介绍请看：<a href=../common/unicodeStandard.md>Unicode 学习笔记</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code class=language-java data-lang=java><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-java data-lang=java><span class=cm>/**
</span><span class=cm>    在构造一个 String 对象时，String 会尝试对传入的参数进行压缩。比如
</span><span class=cm>
</span><span class=cm>    String latin1 = new String(&#34;latin1&#34;.toCharArray());
</span><span class=cm>    String utf16 = new String(&#34;使用 UTF-16 字符集&#34;.toCharArray());
</span><span class=cm>
</span><span class=cm>    入参是 char[]，java 中 char 是两个字节，byte 是一个字节，压缩后 latin1 的 value 字段是 6 个 byte，utf16 无法进行压缩，所以依旧是 26 个 byte。
</span><span class=cm>
</span><span class=cm>    下面是 java.lang.StringUTF16 中进行压缩的函数。
</span><span class=cm> */</span>
    <span class=c1>// compressedCopy char[] -&gt; byte[]
</span><span class=c1></span>    <span class=nd>@HotSpotIntrinsicCandidate</span>
    <span class=kd>public</span> <span class=nf>static</span> <span class=kt>int</span> <span class=nf>compress</span><span class=p>(</span><span class=kt>char</span><span class=p>[]</span> <span class=nf>src</span><span class=p>,</span> <span class=kt>int</span> <span class=nf>srcOff</span><span class=p>,</span> <span class=kt>byte</span><span class=p>[]</span> <span class=nf>dst</span><span class=p>,</span> <span class=kt>int</span> <span class=nf>dstOff</span><span class=p>,</span> <span class=kt>int</span> <span class=nf>len</span><span class=p>)</span> <span class=p>{</span>
        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=nf>i</span> <span class=o>=</span> <span class=n>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>len</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
            <span class=kt>char</span> <span class=nf>c</span> <span class=o>=</span> <span class=n>src</span><span class=p>[</span><span class=n>srcOff</span><span class=p>];</span>
            <span class=k>if</span> <span class=p>(</span><span class=n>c</span> <span class=o>&gt;</span> <span class=n>0xFF</span><span class=p>)</span> <span class=p>{</span>     <span class=c1>// 超出了 LATIN1 所能表示的范围，直接返回不再压缩
</span><span class=c1></span>                <span class=n>len</span> <span class=o>=</span> <span class=n>0</span><span class=p>;</span>
                <span class=k>break</span><span class=p>;</span>
            <span class=p>}</span>
            <span class=n>dst</span><span class=p>[</span><span class=n>dstOff</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=kt>byte</span><span class=p>)</span><span class=n>c</span><span class=p>;</span>
            <span class=n>srcOff</span><span class=o>++</span><span class=p>;</span>
            <span class=n>dstOff</span><span class=o>++</span><span class=p>;</span>
        <span class=p>}</span>
        <span class=k>return</span> <span class=n>len</span><span class=p>;</span>
    <span class=p>}</span></code></pre></td></tr></table></div></div><h2 id=重要域成员>重要域成员</h2><ol><li><code>private final byte[] value;</code><ul><li>用来存储字符串的字节序列。</li></ul></li><li><code>private final byte coder;</code><ul><li>用来暗示 <code>value</code> 中的字节数组的编码方式。有 <code>LATIN1 &amp; UTF16</code> 可选。</li><li><code>static final byte LATIN1 = 0;</code></li><li><code>static final byte UTF16 = 1;</code></li></ul></li><li><code>private int hash;</code><ul><li>缓存字符串哈希值。默认是 0. 在 首次调用 <code>hashCode()</code> 方法时计算并缓存。</li></ul></li><li><code>static final boolean COMPACT_STRINGS;</code><ul><li>用来决定 <code>value</code> 是否进行压缩，默认是 true（压缩）。如果是 false 的话那么总是使用 UTF16 来编码字符串的字节流。在 <code>String</code> 类中，该域使用静态初始化块进行初始化。</li></ul></li></ol><h2 id=重要方法>重要方法</h2><ul><li>TIPS：本来计划中有这部分的内容，但是读过源码理解了字符集的概念和 <code>String</code> 的处理方式以后感觉这部分就不需要再写了，有兴趣可以自己看。</li></ul><h3 id=代码点及代码单元>代码点及代码单元</h3><h3 id=比较>比较</h3><h3 id=搜索>搜索</h3><h3 id=提取子串>提取子串</h3><h3 id=创建全大写-全小写副本>创建全大写/全小写副本</h3><h2 id=一些体会>一些体会</h2><p>理解 <code>String</code> 类最重要的不是会用 <code>String</code> 的 API，而是对字符集本身的理解，字符集是什么，它解决了什么问题，字符是怎么编码的等等，只有很好的理解了字符集才能很好的理解 <code>String</code> 的行为。</p><h2 id=参考>参考</h2><ol><li><a href=https://docs.oracle.com/javase/9/docs/api/java/lang/String.html>java.lang.String</a></li><li><a href=https://docs.oracle.com/javase/specs/jls/se9/html/jls-15.html#jls-15.18.1>15.18.1. String Concatenation Operator +</a></li><li><a href=https://docs.oracle.com/javase/9/docs/api/java/io/Serializable.html>Serializable</a></li><li><a href=http://www.cnblogs.com/chenfei0801/archive/2013/04/05/3001149.html>JAVA 对象序列化（一）——Serializable</a></li><li><a href=https://docs.oracle.com/javase/9/docs/api/java/lang/CharSequence.html>CharSequence</a></li><li><a href=https://en.wikipedia.org/wiki/ISO/IEC_8859-1>ISO/IEC 8859-1</a></li></ol></div><div class=post-copyright><p class=copyright-item><span class=item-title>Author</span>
<span class=item-content>Gravel</span></p><p class=copyright-item><span class=item-title>LastMod</span>
<span class=item-content>2018-03-12</span></p><p class=copyright-item><span class=item-title>License</span>
<span class=item-content><a rel="license noopener" href=https://creativecommons.org/licenses/by-nc-nd/4.0/ target=_blank>CC BY-NC-ND 4.0</a></span></p></div><footer class=post-footer><div class=post-tags><a href=/tags/java/>java</a></div><nav class=post-nav><a class=prev href=/post/gitment/><i class="iconfont icon-left"></i><span class="prev-text nav-default">使用Gitment作为博客评论插件</span>
<span class="prev-text nav-mobile">Prev</span></a>
<a class=next href=/post/%E7%94%9F%E6%88%90ssh-key/><span class="next-text nav-default">git 生成SSH key</span>
<span class="next-text nav-mobile">Next</span>
<i class="iconfont icon-right"></i></a></nav></footer></article></div><div id=disqus_thread></div><script type=text/javascript>(function(){if(window.location.hostname==='localhost')return;var dsq=document.createElement('script');dsq.type='text/javascript';dsq.async=true;var disqus_shortname='leongravel';dsq.src='//'+disqus_shortname+'.disqus.com/embed.js';(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(dsq);})();</script><noscript>Please enable JavaScript to view the <a href=http://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></div></main><footer id=footer class=footer><div class=social-links><a href=mailto:leebroncc@gmail.com class="iconfont icon-email" title=email></a><a href=https://twitter.com/leebroncc class="iconfont icon-twitter" title=twitter></a><a href=https://github.com/leonGravel class="iconfont icon-github" title=github></a><a href=https://www.zhihu.com/people/gravel-20/activities class="iconfont icon-zhihu" title=zhihu></a><a href=https://space.bilibili.com/321842652/#/ class="iconfont icon-bilibili" title=bilibili></a><a href=https://leongravel.com/index.xml type=application/rss+xml class="iconfont icon-rss" title=rss></a></div><div class=copyright><span class=power-by>Powered by <a class=hexo-link href=https://gohugo.io>Hugo</a></span>
<span class=division>|</span>
<span class=theme-info>Theme -
<a class=theme-link href=https://github.com/olOwOlo/hugo-theme-even>Even</a></span><div class=busuanzi-footer><span id=busuanzi_container_site_pv>site pv: <span id=busuanzi_value_site_pv><img src=/img/spinner.svg alt=spinner.svg></span></span>
<span class=division>|</span>
<span id=busuanzi_container_site_uv>site uv: <span id=busuanzi_value_site_uv><img src=/img/spinner.svg alt=spinner.svg></span></span></div><span class=copyright-year>&copy;
2016 -
2019
<span class=heart><i class="iconfont icon-heart"></i></span><span class=author>Gravel</span></span></div></footer><div class=back-to-top id=back-to-top><i class="iconfont icon-up"></i></div></div><script src=https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin=anonymous></script><script type=text/javascript src=/dist/even.ece58db6.min.js></script></body></html>